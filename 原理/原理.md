# 计算机原理及其他相关内容

## 什么是内存对齐？为什么要内存对齐？
### 什么是内存对齐 
关于什么是内存对齐，我们先来看几个例子
```cpp
typedef struct {
    int a;
    double b;
    short c;
}A;
typedef struct {
    int a;
    short b;
    double c;
}B;
```
分别对他们求大小，`sizeof(A)`,`sizeof(B)`我们所得到的结果是不同的， 
`sizeof(A)=24`而`sizeof(B)=16`为什么会产生不一样的结果呢？ 
这是非常简单的一个例子，体现了结构体的内存对齐规则。 
在结构体中，从结构体的首地址开始，假设地址从0开始。 
对结构体A来说，a占4个字节，占从0~3的字节，b是double类型占8个字节，占从8~15的字节，c占两个字节，从16~17的字节。 
对结构体B来说，a占4个字节，从0~3，b占两个字节从4~6；c占8个字节从8~15。 
这就是内存对齐，对齐规则是按照成员的声明顺序，依次安排内存，其偏移量为成员大小的整数倍，0看做任何成员的整数倍，最后结构体的大小为最大成员的整数倍（所以这里的A的大小是24，而不是18）。
### 为什么要内存对齐？ 
- 平台原因(移植原因)：不是所有的硬件平台都能访问任意地址上的任意数据的；某些硬件平台只能在某些地址处取某些特定类型的数据，否则抛出硬件异常。 
- 性能原因：数据结构(尤其是栈)应该尽可能地在自然边界上对齐。原因在于，为了访问未对齐的内存，处理器需要作两次内存访问；而对齐的内存访问仅需要一次访问。

参考：https://blog.csdn.net/weixin_40853073/article/details/81451792